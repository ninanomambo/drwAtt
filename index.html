<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#4a4a4a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Darakwon Attendance">
    
    <!-- PWA Í¥ÄÎ†® Î©îÌÉÄÌÉúÍ∑∏ Î∞è ÎßÅÌÅ¨ -->
    <link rel="manifest" href="/drwAtt/manifest.json">
    <link rel="icon" href="/drwAtt/icon.png">
    <link rel="apple-touch-icon" href="/drwAtt/icon.png">
    
    <!-- Ïò§ÌîàÍ∑∏ÎûòÌîÑ Î©îÌÉÄÌÉúÍ∑∏ -->
    <meta property="og:title" content="Darakwon Attendance - Í∞ÑÌé∏Ìïú Ï∂úÌá¥Í∑º Í∏∞Î°ù Í¥ÄÎ¶¨ Ïï±">
    <meta property="og:description" content="Îã§ÎùΩÏõê Í∑ºÌÉúÍ∏∞Î°ù Ïï±">
    <meta property="og:image" content="/drwAtt/og_image.png">
    <meta property="og:url" content="https://ninanomambo.github.io/drwAtt/">
    <meta property="og:type" content="website">
    
    <!-- Ìä∏ÏúÑÌÑ∞ Ïπ¥Îìú -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Darakwon Attendance - Í∞ÑÌé∏Ìïú Ï∂úÌá¥Í∑º Í∏∞Î°ù Í¥ÄÎ¶¨ Ïï±">
    <meta name="twitter:description" content="Îã§ÎùΩÏõê Í∑ºÌÉúÍ∏∞Î°ù Ïï±">
    <meta name="twitter:image" content="og_image.png">
    
    <title>Darakwon Attendance Ver 0.1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background-color: #f7f7f7;
            height: 100vh;
            width: 100%;
            overflow-x: hidden;
            position: fixed;
        }
        
        .app-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: env(safe-area-inset-top, 20px) env(safe-area-inset-right, 20px) env(safe-area-inset-bottom, 20px) env(safe-area-inset-left, 20px);
            background-color: white;
        }
        
        .app-header {
            width: 100%;
            padding: 20px 0;
            border-bottom: 1px solid #f2f2f2;
            margin-bottom: 30px;
        }
        
        .app-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            text-align: center;
        }
        
        .main-content {
            flex: 1;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            max-width: 500px;
            padding: 0 20px;
        }
        
        .main-buttons {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            gap: 20px;
        }
        
        .btn {
            padding: 25px 10px;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, opacity 0.2s ease;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .btn:active {
            transform: scale(0.97);
            opacity: 0.9;
        }
        
        .btn-icon {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .clock-in {
            background-color: white;
            color: #333;
            border: 2px solid #e6e6e6;
        }
        
        .clock-out {
            background-color: #4a4a4a;
            color: white;
        }
        
        .attendance-btn-container {
            width: 100%;
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .attendance-btn {
            background-color: #f2f2f2;
            color: #555;
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            max-width: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .attendance-btn:active {
            transform: scale(0.97);
            background-color: #e8e8e8;
        }
        
        .attendance-btn-icon {
            margin-right: 8px;
        }

        .data-management {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
            width: 100%;
            flex-wrap: wrap; /* Î≤ÑÌäºÏù¥ ÎßéÏïÑÏßà Í≤ΩÏö∞ ÏûêÎèô Ï§ÑÎ∞îÍøà */
        }
        
        .data-btn {
            background-color: #f2f2f2;
            color: #555;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 14px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            min-width: 90px;
            max-width: 140px;
        }
        
        .data-btn:active {
            transform: scale(0.97);
            background-color: #e8e8e8;
        }
        
        .data-btn-icon {
            margin-right: 5px;
        }
        
        .status-indicator {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
            display: inline-block;
        }
        
        .status-online {
            background-color: #4CAF50;
        }
        
        .status-offline {
            background-color: #F44336;
        }
        
        .sync-status {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin: 5px 0;
        }
        
        .current-time {
            text-align: center;
            font-size: 14px;
            color: #777;
            margin-top: auto;
            padding: 15px 0;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .attendance-sheet {
            background-color: white;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            border-radius: 15px;
            padding: 20px;
            overflow-y: auto;
            margin: 20px auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }
        
        .modal-content {
            background-color: white;
            width: 90%;
            max-width: 400px;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            color: #555;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .form-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .modal-btn {
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            border: none;
            cursor: pointer;
        }
        
        .modal-btn-cancel {
            background-color: #f2f2f2;
            color: #555;
        }
        
        .modal-btn-save {
            background-color: #4a4a4a;
            color: white;
        }
        
        .sheet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            background-color: white;
            padding: 5px 0;
            z-index: 5;
        }
        
        .sheet-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
        }
        
        .sheet-title span {
            margin-right: 8px;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: #555;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .close-btn:active {
            background-color: #f2f2f2;
        }
        
        .week-section {
            margin-bottom: 25px;
        }
        
        .week-title {
            background-color: #f2f2f2;
            padding: 12px 15px;
            font-weight: 600;
            color: #333;
            border-radius: 10px 10px 0 0;
            text-align: left;
        }
        
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            table-layout: fixed;
        }
        
        .attendance-table th {
            background-color: #f7f7f7;
            padding: 10px 5px;
            text-align: center;
            font-weight: 500;
            color: #555;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }
        
        .attendance-table td {
            padding: 12px 5px;
            text-align: center;
            border-bottom: 1px solid #eee;
            color: #333;
            font-size: 13px;
            word-break: keep-all;
            white-space: nowrap;
        }
        
        .attendance-table th:first-child,
        .attendance-table td:first-child {
            width: 15%;
        }
        
        .attendance-table th:nth-child(2),
        .attendance-table td:nth-child(2) {
            width: 20%;
        }
        
        .attendance-table th:nth-child(3), 
        .attendance-table th:nth-child(4),
        .attendance-table td:nth-child(3), 
        .attendance-table td:nth-child(4) {
            width: 20%;
        }
        
        .attendance-table th:last-child,
        .attendance-table td:last-child {
            width: 25%;
        }
        
        .week-total {
            text-align: right;
            padding: 12px 15px;
            font-weight: 600;
            color: #333;
            background-color: #f9f9f9;
            border-radius: 0 0 10px 10px;
        }
        
        /* Î™®Î∞îÏùº ÏµúÏ†ÅÌôî Ï∂îÍ∞Ä Ïä§ÌÉÄÏùº */
        .vibrate {
            animation: vibrate 0.3s linear;
        }
        
        @keyframes vibrate {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }
        
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 20px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
            max-width: 80%;
            text-align: center;
            pointer-events: none;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        /* PWA ÏÑ§Ïπò ÏïåÎ¶º Î∞∞ÎÑà Ïä§ÌÉÄÏùº */
        .install-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #4a4a4a;
            color: white;
            padding: 15px;
            display: none;
            justify-content: space-between;
            align-items: center;
            z-index: 99;
        }
        
        .install-text {
            flex: 1;
            font-size: 14px;
        }
        
        .install-btn {
            background-color: white;
            color: #4a4a4a;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            font-weight: bold;
            margin: 0 10px;
            cursor: pointer;
        }
        
        .install-close {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
        }
        
        /* Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÌÜµÌï© Ïä§ÌÉÄÏùº */
        .google-section {
            margin-top: 10px;
            border-top: 1px solid #eee;
            padding-top: 10px;
        }
        
        .google-title {
            font-size: 14px;
            color: #555;
            text-align: center;
            margin-bottom: 10px;
        }
        
        @media (max-width: 380px) {
            .btn {
                padding: 20px 10px;
                font-size: 16px;
            }
            
            .app-title {
                font-size: 18px;
            }
            
            .attendance-table {
                font-size: 12px;
            }
            
            .attendance-table th,
            .attendance-table td {
                padding: 8px 4px;
            }
            
            .sheet-title {
                font-size: 16px;
            }
            
            .data-btn {
                font-size: 12px;
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="app-header">
            <h1 class="app-title">Darakwon Attendance Ver 0.1</h1>
        </div>
        
        <div class="main-content">
            <div class="main-buttons">
                <button class="btn clock-in" id="clockInBtn">
                    <span class="btn-icon">‚è∞</span>
                    Ï∂úÍ∑º
                </button>
                <button class="btn clock-out" id="clockOutBtn">
                    <span class="btn-icon">üè†</span>
                    Ìá¥Í∑º
                </button>
            </div>
            
            <div class="attendance-btn-container">
                <button class="attendance-btn" id="attendanceBtn">
                    <span class="attendance-btn-icon">üìã</span>
                    Ï∂úÍ∑ºÎ∂Ä
                </button>
            </div>
            
            <div class="data-management">
                <button class="data-btn" id="backupBtn">
                    <span class="data-btn-icon">üíæ</span>
                    Î∞±ÏóÖ
                </button>
                <button class="data-btn" id="restoreBtn">
                    <span class="data-btn-icon">üìÇ</span>
                    Î≥µÏõê
                </button>
                <input type="file" id="restoreInput" accept=".json" style="display: none;">
            </div>
            
            <div class="google-section">
                <div class="google-title">Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô</div>
                <div class="data-management">
                    <button class="data-btn" id="googleConfigBtn">
                        <span class="data-btn-icon">‚öôÔ∏è</span>
                        Google Ï†ïÎ≥¥Ï†ÄÏû•
                    </button>
                    <button class="data-btn" id="googleBackupBtn">
                        <span class="data-btn-icon">‚òÅÔ∏è</span>
                        Google Î∞±ÏóÖ
                    </button>
                    <button class="data-btn" id="googleRestoreBtn">
                        <span class="data-btn-icon">üì•</span>
                        Google Î≥µÏõê
                    </button>
                </div>
            </div>
            
            <div class="sync-status" id="googleStatus">Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: ÏÑ§Ï†ï ÌïÑÏöî</div>
            
            <div class="status-indicator">
                <span class="status-dot" id="storageStatus"></span>
                <span id="storageStatusText">Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå: ÌôïÏù∏ Ï§ë...</span>
            </div>
            
            <div class="current-time" id="currentTime"></div>
        </div>
    </div>
    
    <div class="overlay" id="overlay">
        <div class="attendance-sheet">
            <div class="sheet-header">
                <div class="sheet-title">
                    <span>üìã</span> Í∑ºÌÉú Ï∂úÍ∑ºÎ∂Ä
                </div>
                <button class="close-btn" id="closeBtn">√ó</button>
            </div>
            
            <div class="week-section" id="currentWeek">
                <div class="week-title">‚ñ† Ïù¥Î≤àÏ£º</div>
                <table class="attendance-table" id="currentWeekTable">
                    <thead>
                        <tr>
                            <th>ÎÇ†Ïßú</th>
                            <th>ÏöîÏùº</th>
                            <th>Ï∂úÍ∑º</th>
                            <th>Ìá¥Í∑º</th>
                            <th>Í∑ºÎ¨¥ÏãúÍ∞Ñ</th>
                        </tr>
                    </thead>
                    <tbody id="currentWeekBody">
                        <!-- Ïù¥Î≤àÏ£º Îç∞Ïù¥ÌÑ∞Í∞Ä ÎèôÏ†ÅÏúºÎ°ú Ï±ÑÏõåÏßëÎãàÎã§ -->
                    </tbody>
                </table>
                <div class="week-total" id="currentWeekTotal">Ï£ºÏ§ëÍ∑ºÎ¨¥ÏãúÍ∞Ñ(Ïõî~Í∏à): 0ÏãúÍ∞Ñ</div>
            </div>
            
            <div class="week-section" id="lastWeek">
                <div class="week-title">‚ñ† ÏßÄÎÇúÏ£º</div>
                <table class="attendance-table" id="lastWeekTable">
                    <thead>
                        <tr>
                            <th>ÎÇ†Ïßú</th>
                            <th>ÏöîÏùº</th>
                            <th>Ï∂úÍ∑º</th>
                            <th>Ìá¥Í∑º</th>
                            <th>Í∑ºÎ¨¥ÏãúÍ∞Ñ</th>
                        </tr>
                    </thead>
                    <tbody id="lastWeekBody">
                        <!-- ÏßÄÎÇúÏ£º Îç∞Ïù¥ÌÑ∞Í∞Ä ÎèôÏ†ÅÏúºÎ°ú Ï±ÑÏõåÏßëÎãàÎã§ -->
                    </tbody>
                </table>
                <div class="week-total" id="lastWeekTotal">Ï£ºÏ§ëÍ∑ºÎ¨¥ÏãúÍ∞Ñ(Ïõî~Í∏à): 0ÏãúÍ∞Ñ</div>
            </div>
        </div>
    </div>
    
    <!-- Íµ¨Í∏Ä API Ï†ïÎ≥¥ ÏûÖÎ†• Î™®Îã¨ -->
    <div class="modal" id="googleConfigModal">
        <div class="modal-content">
            <div class="modal-title">Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å API ÏÑ§Ï†ï</div>
            <div class="form-group">
                <label for="apiKey">API Key</label>
                <input type="text" id="apiKey" placeholder="Google Cloud ConsoleÏóêÏÑú ÏÉùÏÑ±Ìïú API Key">
            </div>
            <div class="form-group">
                <label for="clientId">Client ID</label>
                <input type="text" id="clientId" placeholder="Google Cloud ConsoleÏóêÏÑú ÏÉùÏÑ±Ìïú Client ID">
            </div>
            <div class="form-buttons">
                <button class="modal-btn modal-btn-cancel" id="configCancelBtn">Ï∑®ÏÜå</button>
                <button class="modal-btn modal-btn-save" id="configSaveBtn">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>
    
    <!-- PWA ÏÑ§Ïπò ÏïåÎ¶º Î∞∞ÎÑà -->
    <div class="install-banner" id="installBanner">
        <div class="install-text">Ìôà ÌôîÎ©¥Ïóê Ï∂îÍ∞ÄÌïòÏó¨ Ïï±Ï≤òÎüº ÏÇ¨Ïö©ÌïòÏÑ∏Ïöî!</div>
        <button class="install-btn" id="installBtn">ÏÑ§Ïπò</button>
        <button class="install-close" id="installClose">√ó</button>
    </div>
    
    <div class="toast" id="toast"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM ÏöîÏÜå
            const clockInBtn = document.getElementById('clockInBtn');
            const clockOutBtn = document.getElementById('clockOutBtn');
            const attendanceBtn = document.getElementById('attendanceBtn');
            const overlay = document.getElementById('overlay');
            const closeBtn = document.getElementById('closeBtn');
            const currentTimeElem = document.getElementById('currentTime');
            const storageStatus = document.getElementById('storageStatus');
            const storageStatusText = document.getElementById('storageStatusText');
            const toast = document.getElementById('toast');
            const installBanner = document.getElementById('installBanner');
            const installBtn = document.getElementById('installBtn');
            const installClose = document.getElementById('installClose');
            const googleConfigBtn = document.getElementById('googleConfigBtn');
            const googleBackupBtn = document.getElementById('googleBackupBtn');
            const googleRestoreBtn = document.getElementById('googleRestoreBtn');
            const googleConfigModal = document.getElementById('googleConfigModal');
            const apiKeyInput = document.getElementById('apiKey');
            const clientIdInput = document.getElementById('clientId');
            const configSaveBtn = document.getElementById('configSaveBtn');
            const configCancelBtn = document.getElementById('configCancelBtn');
            const googleStatus = document.getElementById('googleStatus');
            
            // ÏÑúÎπÑÏä§ ÏõåÏª§ Îì±Î°ù
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/drwAtt/sw.js')
                        .then(registration => {
                            console.log('ÏÑúÎπÑÏä§ ÏõåÏª§ Îì±Î°ù ÏÑ±Í≥µ:', registration.scope);
                        })
                        .catch(error => {
                            console.error('ÏÑúÎπÑÏä§ ÏõåÏª§ Îì±Î°ù Ïã§Ìå®:', error);
                        });
                });
            }
            
            // PWA ÏÑ§Ïπò Ïù¥Î≤§Ìä∏ Ï≤òÎ¶¨
            let deferredPrompt;
            
            window.addEventListener('beforeinstallprompt', (e) => {
                // Í∏∞Î≥∏ ÏÑ§Ïπò ÌîÑÎ°¨ÌîÑÌä∏ ÌëúÏãú Î∞©ÏßÄ
                e.preventDefault();
                // Ïù¥Î≤§Ìä∏ Ï†ÄÏû•
                deferredPrompt = e;
                // ÏÑ§Ïπò Î∞∞ÎÑà ÌëúÏãú
                installBanner.style.display = 'flex';
            });
            
            // ÏÑ§Ïπò Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            installBtn.addEventListener('click', () => {
                // Î∞∞ÎÑà Ïà®Í∏∞Í∏∞
                installBanner.style.display = 'none';
                // ÏÑ§Ïπò ÌîÑÎ°¨ÌîÑÌä∏ ÌëúÏãú
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('ÏÇ¨Ïö©ÏûêÍ∞Ä Ïï± ÏÑ§ÏπòÎ•º ÏàòÎùΩÌñàÏäµÎãàÎã§');
                            showToast('Ïï±Ïù¥ ÏÑ§ÏπòÎêòÏóàÏäµÎãàÎã§');
                        } else {
                            console.log('ÏÇ¨Ïö©ÏûêÍ∞Ä Ïï± ÏÑ§ÏπòÎ•º Í±∞Î∂ÄÌñàÏäµÎãàÎã§');
                        }
                        deferredPrompt = null;
                    });
                }
            });
            
            // ÏÑ§Ïπò Î∞∞ÎÑà Îã´Í∏∞ Î≤ÑÌäº
            installClose.addEventListener('click', () => {
                installBanner.style.display = 'none';
            });
            
            // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÎèôÍ∏∞Ìôî Í¥ÄÎ¶¨Ïûê
            const GoogleDriveManager = {
                API_KEY: null,
                CLIENT_ID: null,
                FILE_ID: null,
                FILE_NAME: 'darakwon-attendance-data.json',
                API_DISCOVERY_DOCS: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],
                API_SCOPES: 'https://www.googleapis.com/auth/drive.file',
                isInitialized: false,
                
                // Íµ¨Í∏Ä Ï†ïÎ≥¥ Î°úÎìú
                loadConfig: function() {
                    try {
                        const googleConfig = localStorage.getItem('googleDriveConfig');
                        if (googleConfig) {
                            const config = JSON.parse(googleConfig);
                            this.API_KEY = config.apiKey;
                            this.CLIENT_ID = config.clientId;
                            this.FILE_ID = config.fileId;
                            
                            // UI ÏöîÏÜå ÏóÖÎç∞Ïù¥Ìä∏
                            apiKeyInput.value = this.API_KEY;
                            clientIdInput.value = this.CLIENT_ID;
                            
                            return true;
                        }
                        return false;
                    } catch (error) {
                        console.error('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÏÑ§Ï†ï Î°úÎìú Ïò§Î•ò:', error);
                        return false;
                    }
                },
                
                // Íµ¨Í∏Ä Ï†ïÎ≥¥ Ï†ÄÏû•
                saveConfig: function(apiKey, clientId, fileId = null) {
                    try {
                        this.API_KEY = apiKey;
                        this.CLIENT_ID = clientId;
                        if (fileId) this.FILE_ID = fileId;
                        
                        const config = {
                            apiKey: this.API_KEY,
                            clientId: this.CLIENT_ID,
                            fileId: this.FILE_ID
                        };
                        
                        localStorage.setItem('googleDriveConfig', JSON.stringify(config));
                        return true;
                    } catch (error) {
                        console.error('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÏÑ§Ï†ï Ï†ÄÏû• Ïò§Î•ò:', error);
                        return false;
                    }
                },
                
                // Google API Î°úÎìú Î∞è Ï¥àÍ∏∞Ìôî
                init: function() {
                    if (!this.API_KEY || !this.CLIENT_ID) {
                        googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: API ÌÇ§ Î∞è ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ID ÏÑ§Ï†ï ÌïÑÏöî';
                        return Promise.reject(new Error('API ÌÇ§ Î∞è ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ IDÍ∞Ä ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.'));
                    }
                    
                    return new Promise((resolve, reject) => {
                        // Google API ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÎùºÏù¥Î∏åÎü¨Î¶¨Í∞Ä Ïù¥ÎØ∏ Î°úÎìúÎêòÏóàÎäîÏßÄ ÌôïÏù∏
                        if (window.gapi && window.gapi.client) {
                            this.initClient().then(resolve).catch(reject);
                            return;
                        }
                        
                        // Google API ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎìú
                        const script = document.createElement('script');
                        script.src = 'https://apis.google.com/js/api.js';
                        script.onload = () => {
                            gapi.load('client:auth2', () => {
                                this.initClient().then(resolve).catch(reject);
                            });
                        };
                        script.onerror = (error) => reject(error);
                        document.body.appendChild(script);
                    });
                },
                
                // API ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï¥àÍ∏∞Ìôî
                initClient: function() {
                    return gapi.client.init({
                        apiKey: this.API_KEY,
                        clientId: this.CLIENT_ID,
                        discoveryDocs: this.API_DISCOVERY_DOCS,
                        scope: this.API_SCOPES
                    }).then(() => {
                        // Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
                        if (gapi.auth2.getAuthInstance().isSignedIn.get()) {
                            this.isInitialized = true;
                            googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: Ïó∞Í≤∞Îê®';
                            // ÌååÏùº IDÍ∞Ä ÏóÜÏúºÎ©¥ Ï∞æÍ∏∞
                            if (!this.FILE_ID) {
                                return this.findOrCreateFile().then(() => {
                                    return true;
                                });
                            }
                            return true;
                        } else {
                            googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: Î°úÍ∑∏Ïù∏ ÌïÑÏöî';
                            return this.signIn();
                        }
                    }).catch(error => {
                        googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: Ï¥àÍ∏∞Ìôî Ïã§Ìå®';
                        console.error('Íµ¨Í∏Ä API ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ï¥àÍ∏∞Ìôî Ïò§Î•ò:', error);
                        throw error;
                    });
                },
                
                // Î°úÍ∑∏Ïù∏
                signIn: function() {
                    if (!gapi || !gapi.auth2) {
                        return Promise.reject(new Error('Google APIÍ∞Ä Ï¥àÍ∏∞ÌôîÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.'));
                    }
                    
                    return gapi.auth2.getAuthInstance().signIn()
                        .then(() => {
                            this.isInitialized = true;
                            googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ';
                            // ÌååÏùº IDÍ∞Ä ÏóÜÏúºÎ©¥ Ï∞æÍ∏∞
                            if (!this.FILE_ID) {
                                return this.findOrCreateFile();
                            }
                            return true;
                        })
                        .catch(error => {
                            googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: Î°úÍ∑∏Ïù∏ Ïã§Ìå®';
                            console.error('Google Î°úÍ∑∏Ïù∏ Ïò§Î•ò:', error);
                            throw error;
                        });
                },
                
                // ÌååÏùº Ï∞æÍ∏∞ ÎòêÎäî ÏÉùÏÑ±ÌïòÍ∏∞
                findOrCreateFile: function() {
                    return new Promise((resolve, reject) => {
                        // ÌååÏùº Í≤ÄÏÉâ
                        gapi.client.drive.files.list({
                            q: `name='${this.FILE_NAME}' and trashed=false`,
                            spaces: 'drive',
                            fields: 'files(id, name, modifiedTime)'
                        }).then(response => {
                            const files = response.result.files;
                            if (files && files.length > 0) {
                                // ÌååÏùºÏù¥ Ï°¥Ïû¨ÌïòÎ©¥ ID Ï†ÄÏû•
                                this.FILE_ID = files[0].id;
                                this.saveConfig(this.API_KEY, this.CLIENT_ID, this.FILE_ID);
                                googleStatus.textContent = `Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: ÌååÏùº Ï∞æÏùå (ÎßàÏßÄÎßâ ÏàòÏ†ï: ${new Date(files[0].modifiedTime).toLocaleString()})`;
                                resolve(this.FILE_ID);
                            } else {
                                // ÌååÏùºÏù¥ ÏóÜÏúºÎ©¥ ÏÉàÎ°ú ÏÉùÏÑ±
                                return this.createFile().then(fileId => {
                                    resolve(fileId);
                                });
                            }
                        }).catch(error => {
                            console.error('ÌååÏùº Ï∞æÍ∏∞ Ïò§Î•ò:', error);
                            reject(error);
                        });
                    });
                },
                
                // ÏÉà ÌååÏùº ÏÉùÏÑ±ÌïòÍ∏∞
                createFile: function() {
                    return new Promise((resolve, reject) => {
                        // Îπà JSON Í∞ùÏ≤¥Î°ú Ï¥àÍ∏∞ÌôîÌï† ÌååÏùº ÎÇ¥Ïö©
                        const fileContent = JSON.stringify({});
                        
                        // ÌååÏùº Î©îÌÉÄÎç∞Ïù¥ÌÑ∞
                        const metadata = {
                            name: this.FILE_NAME,
                            mimeType: 'application/json'
                        };
                        
                        // Î∞îÏù¥ÎÑàÎ¶¨ Îç∞Ïù¥ÌÑ∞Î°ú Î≥ÄÌôò
                        const blob = new Blob([fileContent], {type: 'application/json'});
                        
                        // ÌååÏùº ÏÉùÏÑ± ÏöîÏ≤≠
                        const form = new FormData();
                        form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
                        form.append('file', blob);
                        
                        fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                            method: 'POST',
                            headers: new Headers({
                                'Authorization': 'Bearer ' + gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token
                            }),
                            body: form
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.id) {
                                this.FILE_ID = data.id;
                                this.saveConfig(this.API_KEY, this.CLIENT_ID, this.FILE_ID);
                                googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: ÏÉà ÌååÏùº ÏÉùÏÑ±Îê®';
                                resolve(this.FILE_ID);
                            } else {
                                reject(new Error('ÌååÏùº ÏÉùÏÑ± ÏùëÎãµÏóêÏÑú IDÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.'));
                            }
                        })
                        .catch(error => {
                            console.error('ÌååÏùº ÏÉùÏÑ± Ïò§Î•ò:', error);
                            reject(error);
                        });
                    });
                },
                
                // ÌååÏùº Î∞±ÏóÖ (Í∏∞Ï°¥ ÌååÏùº ÎçÆÏñ¥Ïì∞Í∏∞)
                backupFile: function(jsonData) {
                    return new Promise((resolve, reject) => {
                        if (!this.isInitialized) {
                            this.init().then(() => {
                                this.backupFile(jsonData).then(resolve).catch(reject);
                            }).catch(reject);
                            return;
                        }
                        
                        if (!this.FILE_ID) {
                            this.findOrCreateFile().then(() => {
                                this.backupFile(jsonData).then(resolve).catch(reject);
                            }).catch(reject);
                            return;
                        }
                        
                        // Î∞îÏù¥ÎÑàÎ¶¨ Îç∞Ïù¥ÌÑ∞Î°ú Î≥ÄÌôò
                        const blob = new Blob([jsonData], {type: 'application/json'});
                        
                        // ÌååÏùº ÏóÖÎç∞Ïù¥Ìä∏ ÏöîÏ≤≠
                        fetch(`https://www.googleapis.com/upload/drive/v3/files/${this.FILE_ID}?uploadType=media`, {
                            method: 'PATCH',
                            headers: new Headers({
                                'Authorization': 'Bearer ' + gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token,
                                'Content-Type': 'application/json'
                            }),
                            body: jsonData
                        })
                        .then(response => {
                            if (response.ok) {
                                googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: Î∞±ÏóÖ ÏôÑÎ£å (' + new Date().toLocaleString() + ')';
                                resolve(true);
                            } else {
                                return response.json().then(data => {
                                    reject(new Error(`ÌååÏùº ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®: ${data.error ? data.error.message : response.statusText}`));
                                });
                            }
                        })
                        .catch(error => {
                            console.error('ÌååÏùº ÏóÖÎç∞Ïù¥Ìä∏ Ïò§Î•ò:', error);
                            reject(error);
                        });
                    });
                },
                
                // ÌååÏùº Î≥µÏõê (ÌååÏùºÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞)
                restoreFile: function() {
                    return new Promise((resolve, reject) => {
                        if (!this.isInitialized) {
                            this.init().then(() => {
                                this.restoreFile().then(resolve).catch(reject);
                            }).catch(reject);
                            return;
                        }
                        
                        if (!this.FILE_ID) {
                            this.findOrCreateFile().then(() => {
                                this.restoreFile().then(resolve).catch(reject);
                            }).catch(reject);
                            return;
                        }
                        
                        // ÌååÏùº Îã§Ïö¥Î°úÎìú ÏöîÏ≤≠
                        fetch(`https://www.googleapis.com/drive/v3/files/${this.FILE_ID}?alt=media`, {
                            headers: new Headers({
                                'Authorization': 'Bearer ' + gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token
                            })
                        })
                        .then(response => {
                            if (response.ok) {
                                return response.text();
                            } else {
                                return response.json().then(data => {
                                    throw new Error(`ÌååÏùº Îã§Ïö¥Î°úÎìú Ïã§Ìå®: ${data.error ? data.error.message : response.statusText}`);
                                });
                            }
                        })
                        .then(content => {
                            // Ïú†Ìö®Ìïú JSONÏù∏ÏßÄ ÌôïÏù∏
                            try {
                                const jsonData = JSON.parse(content);
                                googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: Î≥µÏõê ÏôÑÎ£å (' + new Date().toLocaleString() + ')';
                                resolve(jsonData);
                            } catch (error) {
                                reject(new Error('ÌååÏùº ÎÇ¥Ïö©Ïù¥ Ïú†Ìö®Ìïú JSON ÌòïÏãùÏù¥ ÏïÑÎãôÎãàÎã§.'));
                            }
                        })
                        .catch(error => {
                            console.error('ÌååÏùº Îã§Ïö¥Î°úÎìú Ïò§Î•ò:', error);
                            reject(error);
                        });
                    });
                }
            };
            
            // Ïä§ÌÜ†Î¶¨ÏßÄ Í¥ÄÎ¶¨Ïûê - IndexedDB, localStorage ÎòêÎäî Î©îÎ™®Î¶¨ Ïä§ÌÜ†Î¶¨ÏßÄ ÏÇ¨Ïö©
            const StorageManager = {
                memoryStorage: {},
                isIndexedDBAvailable: false,
                isLocalStorageAvailable: false,
                dbName: 'DarakwonAttendanceDB',
                storeName: 'attendanceData',
                db: null,
                
                // Ïä§ÌÜ†Î¶¨ÏßÄ ÏÇ¨Ïö© Í∞ÄÎä• Ïó¨Î∂Ä ÌôïÏù∏ Î∞è Ï¥àÍ∏∞Ìôî
                init: function() {
                    return new Promise((resolve) => {
                        // IndexedDB ÏÇ¨Ïö© Í∞ÄÎä• Ïó¨Î∂Ä ÌôïÏù∏
                        if ('indexedDB' in window) {
                            const request = indexedDB.open(this.dbName, 1);
                            
                            request.onerror = () => {
                                console.log('IndexedDB ÏÇ¨Ïö© Î∂àÍ∞Ä: ÎåÄÏ≤¥ Î∞©Î≤ï ÏãúÎèÑ');
                                this.tryLocalStorage();
                                resolve();
                            };
                            
                            request.onupgradeneeded = (event) => {
                                const db = event.target.result;
                                if (!db.objectStoreNames.contains(this.storeName)) {
                                    db.createObjectStore(this.storeName);
                                }
                            };
                            
                            request.onsuccess = (event) => {
                                this.db = event.target.result;
                                this.isIndexedDBAvailable = true;
                                storageStatus.classList.add('status-online');
                                storageStatusText.textContent = 'Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå: IndexedDB ÏÇ¨Ïö© Ï§ë (ÏòÅÍµ¨ Ï†ÄÏû•)';
                                resolve();
                            };
                        } else {
                            this.tryLocalStorage();
                            resolve();
                        }
                    });
                },
                
                // localStorage ÏÇ¨Ïö© ÏãúÎèÑ
                tryLocalStorage: function() {
                    try {
                        localStorage.setItem('test', 'test');
                        localStorage.removeItem('test');
                        this.isLocalStorageAvailable = true;
                        storageStatus.classList.add('status-online');
                        storageStatusText.textContent = 'Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå: Î°úÏª¨ Ï†ÄÏû•ÏÜå ÏÇ¨Ïö© Ï§ë (ÏòÅÍµ¨ Ï†ÄÏû•)';
                    } catch (e) {
                        this.useMemoryStorage();
                    }
                },
                
                // Î©îÎ™®Î¶¨ Ï†ÄÏû•ÏÜå ÏÇ¨Ïö©
                useMemoryStorage: function() {
                    this.isIndexedDBAvailable = false;
                    this.isLocalStorageAvailable = false;
                    storageStatus.classList.add('status-offline');
                    storageStatusText.textContent = 'Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÏÜå: ÏûÑÏãú Î©îÎ™®Î¶¨ ÏÇ¨Ïö© Ï§ë (Ïï± Ï¢ÖÎ£å Ïãú Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú)';
                    showToast('Ï£ºÏùò: ÌòÑÏû¨ ÏûÑÏãú Ï†ÄÏû•ÏÜåÎ•º ÏÇ¨Ïö© Ï§ëÏûÖÎãàÎã§. ÌéòÏù¥ÏßÄÎ•º Îã´ÏúºÎ©¥ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÇ≠Ï†úÎê©ÎãàÎã§.', 5000);
                },
                
                // Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
                getItem: function(key) {
                    return new Promise((resolve) => {
                        // IndexedDB ÏÇ¨Ïö©
                        if (this.isIndexedDBAvailable) {
                            const transaction = this.db.transaction([this.storeName], 'readonly');
                            const store = transaction.objectStore(this.storeName);
                            const request = store.get(key);
                            
                            request.onsuccess = () => {
                                resolve(request.result);
                            };
                            
                            request.onerror = () => {
                                console.error('IndexedDB Îç∞Ïù¥ÌÑ∞ ÏùΩÍ∏∞ Ïò§Î•ò');
                                resolve(null);
                            };
                        } 
                        // localStorage ÏÇ¨Ïö©
                        else if (this.isLocalStorageAvailable) {
                            resolve(localStorage.getItem(key));
                        } 
                        // Î©îÎ™®Î¶¨ ÏÇ¨Ïö©
                        else {
                            resolve(this.memoryStorage[key]);
                        }
                    });
                },
                
                // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•ÌïòÍ∏∞
                setItem: function(key, value) {
                    return new Promise((resolve) => {
                        // IndexedDB ÏÇ¨Ïö©
                        if (this.isIndexedDBAvailable) {
                            const transaction = this.db.transaction([this.storeName], 'readwrite');
                            const store = transaction.objectStore(this.storeName);
                            const request = store.put(value, key);
                            
                            request.onsuccess = () => {
                                resolve(true);
                            };
                            
                            request.onerror = () => {
                                console.error('IndexedDB Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ïò§Î•ò');
                                resolve(false);
                            };
                        } 
                        // localStorage ÏÇ¨Ïö©
                        else if (this.isLocalStorageAvailable) {
                            try {
                                localStorage.setItem(key, value);
                                resolve(true);
                            } catch (e) {
                                console.error('localStorage Ï†ÄÏû• Ïò§Î•ò', e);
                                resolve(false);
                            }
                        } 
                        // Î©îÎ™®Î¶¨ ÏÇ¨Ïö©
                        else {
                            this.memoryStorage[key] = value;
                            resolve(true);
                        }
                    });
                },
                
                // Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†úÌïòÍ∏∞
                removeItem: function(key) {
                    return new Promise((resolve) => {
                        // IndexedDB ÏÇ¨Ïö©
                        if (this.isIndexedDBAvailable) {
                            const transaction = this.db.transaction([this.storeName], 'readwrite');
                            const store = transaction.objectStore(this.storeName);
                            const request = store.delete(key);
                            
                            request.onsuccess = () => {
                                resolve(true);
                            };
                            
                            request.onerror = () => {
                                console.error('IndexedDB Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú Ïò§Î•ò');
                                resolve(false);
                            };
                        } 
                        // localStorage ÏÇ¨Ïö©
                        else if (this.isLocalStorageAvailable) {
                            localStorage.removeItem(key);
                            resolve(true);
                        } 
                        // Î©îÎ™®Î¶¨ ÏÇ¨Ïö©
                        else {
                            delete this.memoryStorage[key];
                            resolve(true);
                        }
                    });
                }
            };
            
            // ÌÜ†Ïä§Ìä∏ Î©îÏãúÏßÄ ÌëúÏãú Ìï®Ïàò
            function showToast(message, duration = 2000) {
                toast.textContent = message;
                toast.classList.add('show');
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, duration);
            }
            
            // ÏßÑÎèô Ìö®Í≥º Ìï®Ïàò (Î™®Î∞îÏùº)
            function vibrate(element) {
                element.classList.add('vibrate');
                setTimeout(() => {
                    element.classList.remove('vibrate');
                }, 300);
                
                // Î™®Î∞îÏùº Í∏∞Í∏∞ ÏßÑÎèô API (ÏßÄÏõêÎêòÎäî Í≤ΩÏö∞)
                if ('vibrate' in navigator) {
                    navigator.vibrate(100);
                }
            }
            
            // ÌòÑÏû¨ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
            function updateCurrentTime() {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                currentTimeElem.textContent = `ÌòÑÏû¨ ÏãúÍ∞Ñ: ${hours}:${minutes}:${seconds}`;
            }
            
            // 1Ï¥àÎßàÎã§ ÌòÑÏû¨ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
            setInterval(updateCurrentTime, 1000);
            updateCurrentTime();
            
            // ÎÇ†Ïßú ÌòïÏãù Î≥ÄÌôò Ìï®Ïàò
            function formatDate(date) {
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                const hours = String(date.getHours()).padStart(2, '0');
                const minutes = String(date.getMinutes()).padStart(2, '0');
                
                return `${month}Ïõî-${day}Ïùº ${hours}:${minutes}`;
            }
            
            // ÏöîÏùº Íµ¨ÌïòÍ∏∞ Ìï®Ïàò
            function getDayOfWeek(date) {
                const days = ['ÏùºÏöîÏùº', 'ÏõîÏöîÏùº', 'ÌôîÏöîÏùº', 'ÏàòÏöîÏùº', 'Î™©ÏöîÏùº', 'Í∏àÏöîÏùº', 'ÌÜ†ÏöîÏùº'];
                return days[date.getDay()];
            }
            
            // ÎÇ†ÏßúÎ°úÎ∂ÄÌÑ∞ Ï£º ÏãúÏûëÏùº Íµ¨ÌïòÍ∏∞ (ÏùºÏöîÏùº Í∏∞Ï§Ä)
            function getWeekStart(date) {
                const d = new Date(date);
                const day = d.getDay(); // 0 = ÏùºÏöîÏùº, 1 = ÏõîÏöîÏùº, ...
                d.setDate(d.getDate() - day); // Ïù¥Î≤à Ï£º ÏùºÏöîÏùºÎ°ú ÏÑ§Ï†ï
                d.setHours(0, 0, 0, 0); // ÏûêÏ†ïÏúºÎ°ú ÏÑ§Ï†ï
                return d;
            }
            
            // IndexedDB ÎòêÎäî Îã§Î•∏ Ï†ÄÏû•ÏÜåÏóêÏÑú Ï∂úÌá¥Í∑º Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
            async function getAttendanceData() {
                const data = await StorageManager.getItem('attendanceData');
                return data ? JSON.parse(data) : {};
            }
            
            // Ï∂úÌá¥Í∑º Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
            async function saveAttendanceData(data) {
                await StorageManager.setItem('attendanceData', JSON.stringify(data));
            }
            
            // Ï∂úÍ∑º Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            clockInBtn.addEventListener('click', async function() {
                vibrate(this);
                const now = new Date();
                const dateKey = now.toISOString().split('T')[0]; // YYYY-MM-DD ÌòïÏãù
                const attendanceData = await getAttendanceData();
                
                // Ïù¥ÎØ∏ Ï∂úÍ∑º Í∏∞Î°ùÏù¥ ÏûàÏúºÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏ÌïòÏßÄ ÏïäÏùå
                if (!attendanceData[dateKey] || !attendanceData[dateKey].clockIn) {
                    attendanceData[dateKey] = attendanceData[dateKey] || {};
                    attendanceData[dateKey].clockIn = now.getTime();
                    await saveAttendanceData(attendanceData);
                    
                    showToast('Ï∂úÍ∑º ÏãúÍ∞ÑÏù¥ Í∏∞Î°ùÎêòÏóàÏäµÎãàÎã§: ' + formatDate(now));
                } else {
                    showToast('Ïù¥ÎØ∏ Ï∂úÍ∑º Í∏∞Î°ùÏù¥ ÏûàÏäµÎãàÎã§: ' + formatDate(new Date(attendanceData[dateKey].clockIn)));
                }
                
                // 2Ï£ºÍ∞Ä ÏßÄÎÇú Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú
                await cleanupOldData();
            });
            
            // Ìá¥Í∑º Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            clockOutBtn.addEventListener('click', async function() {
                vibrate(this);
                const now = new Date();
                const dateKey = now.toISOString().split('T')[0]; // YYYY-MM-DD ÌòïÏãù
                const attendanceData = await getAttendanceData();
                
                if (!attendanceData[dateKey]) {
                    showToast('Ïò§Îäò Ï∂úÍ∑º Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§. Î®ºÏ†Ä Ï∂úÍ∑ºÏùÑ Îì±Î°ùÌï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }
                
                // Ìá¥Í∑º ÏãúÍ∞ÑÏùÄ Ìï≠ÏÉÅ ÏóÖÎç∞Ïù¥Ìä∏
                attendanceData[dateKey].clockOut = now.getTime();
                await saveAttendanceData(attendanceData);
                
                showToast('Ìá¥Í∑º ÏãúÍ∞ÑÏù¥ Í∏∞Î°ùÎêòÏóàÏäµÎãàÎã§: ' + formatDate(now));
                
                // 2Ï£ºÍ∞Ä ÏßÄÎÇú Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú
                await cleanupOldData();
            });
            
            // 2Ï£º Ïù¥ÏÉÅ ÏßÄÎÇú Îç∞Ïù¥ÌÑ∞ ÏÇ≠Ï†ú
            async function cleanupOldData() {
                const attendanceData = await getAttendanceData();
                const twoWeeksAgo = new Date();
                twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
                twoWeeksAgo.setHours(0, 0, 0, 0);
                
                let hasChanges = false;
                
                for (const dateKey in attendanceData) {
                    const recordDate = new Date(dateKey);
                    if (recordDate < twoWeeksAgo) {
                        delete attendanceData[dateKey];
                        hasChanges = true;
                    }
                }
                
                if (hasChanges) {
                    await saveAttendanceData(attendanceData);
                }
            }
            
            // Í∑ºÎ¨¥ ÏãúÍ∞Ñ Í≥ÑÏÇ∞ (Ï†êÏã¨ ÏãúÍ∞Ñ Ï†úÏô∏, 11ÏãúÍ∞Ñ Ï¥àÍ≥º Ïãú Ï†ÄÎÖÅ ÏãúÍ∞Ñ Ï†úÏô∏)
            function calculateWorkHours(clockIn, clockOut) {
                if (!clockIn || !clockOut) return 0;
                
                const inTime = new Date(clockIn);
                const outTime = new Date(clockOut);
                
                // Ï¥ù Í∑ºÎ¨¥ ÏãúÍ∞Ñ (Î∞ÄÎ¶¨Ï¥à)
                let totalMs = outTime - inTime;
                
                // Ï†êÏã¨ ÏãúÍ∞Ñ Í≥ÑÏÇ∞ (11:30 ~ 12:00)
                const inDate = new Date(inTime);
                const lunchStart = new Date(inDate.setHours(11, 30, 0, 0));
                const lunchEnd = new Date(inDate.setHours(12, 0, 0, 0));
                
                // Ï†êÏã¨ ÏãúÍ∞ÑÏù¥ Í∑ºÎ¨¥ ÏãúÍ∞ÑÏóê Ìè¨Ìï®ÎêòÏñ¥ ÏûàÎäîÏßÄ ÌôïÏù∏
                if (inTime <= lunchEnd && outTime >= lunchStart) {
                    // Ï†êÏã¨ ÏãúÍ∞ÑÏùò Í≤πÏπòÎäî Î∂ÄÎ∂Ñ Í≥ÑÏÇ∞
                    const lunchOverlapStart = Math.max(inTime.getTime(), lunchStart.getTime());
                    const lunchOverlapEnd = Math.min(outTime.getTime(), lunchEnd.getTime());
                    const lunchOverlapMs = lunchOverlapEnd - lunchOverlapStart;
                    
                    // Í≤πÏπòÎäî Ï†êÏã¨ ÏãúÍ∞Ñ Ï†úÏô∏
                    totalMs -= lunchOverlapMs;
                }
                
                // 11ÏãúÍ∞Ñ Ï¥àÍ≥º Í∑ºÎ¨¥Ïù∏ Í≤ΩÏö∞ Ï†ÄÎÖÅ ÏãúÍ∞Ñ 1ÏãúÍ∞Ñ Ï†úÏô∏
                const elevenHoursMs = 11 * 60 * 60 * 1000;
                if (totalMs > elevenHoursMs) {
                    totalMs -= 60 * 60 * 1000; // 1ÏãúÍ∞Ñ (60Î∂Ñ * 60Ï¥à * 1000Î∞ÄÎ¶¨Ï¥à)
                }
                
                // ÏãúÍ∞ÑÏúºÎ°ú Î≥ÄÌôò (Î∞ÄÎ¶¨Ï¥à -> ÏãúÍ∞Ñ)
                const hours = Math.max(0, totalMs / (1000 * 60 * 60));
                return hours;
            }
            
            // Ï∂úÍ∑ºÎ∂Ä Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            attendanceBtn.addEventListener('click', async function() {
                vibrate(this);
                await renderAttendanceSheet();
                overlay.style.display = 'flex';
                document.body.style.overflow = 'hidden'; // Î∞∞Í≤Ω Ïä§ÌÅ¨Î°§ Î∞©ÏßÄ
            });
            
            // Îã´Í∏∞ Î≤ÑÌäº Ïù¥Î≤§Ìä∏
            closeBtn.addEventListener('click', function() {
                overlay.style.display = 'none';
                document.body.style.overflow = ''; // Ïä§ÌÅ¨Î°§ Î≥µÏõê
            });
            
            // Î∞∞Í≤Ω ÌÅ¥Î¶≠ Ïãú Ï∂úÍ∑ºÎ∂Ä Îã´Í∏∞
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) {
                    overlay.style.display = 'none';
                    document.body.style.overflow = ''; // Ïä§ÌÅ¨Î°§ Î≥µÏõê
                }
            });
            
            // ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏ Ï∑®ÏÜå (Ïä§ÏôÄÏù¥ÌîÑ Î∞©ÏßÄ)
            overlay.addEventListener('touchmove', function(e) {
                e.stopPropagation();
            }, { passive: false });
            
            // Ï∂úÍ∑ºÎ∂Ä Î†åÎçîÎßÅ
            async function renderAttendanceSheet() {
                try {
                    const attendanceData = await getAttendanceData();
                    const today = new Date();
                    
                    // Ïù¥Î≤à Ï£º ÏãúÏûëÏùº (ÏùºÏöîÏùº)
                    const currentWeekStart = getWeekStart(today);
                    
                    // ÏßÄÎÇú Ï£º ÏãúÏûëÏùº (Ïù¥Î≤àÏ£º ÏãúÏûëÏùº - 7Ïùº)
                    const lastWeekStart = new Date(currentWeekStart);
                    lastWeekStart.setDate(lastWeekStart.getDate() - 7);
                    
                    // Ïù¥Î≤à Ï£º Îç∞Ïù¥ÌÑ∞ Î†åÎçîÎßÅ
                    renderWeekData(currentWeekStart, 'currentWeekBody', 'currentWeekTotal', attendanceData);
                    
                    // ÏßÄÎÇú Ï£º Îç∞Ïù¥ÌÑ∞ Î†åÎçîÎßÅ
                    renderWeekData(lastWeekStart, 'lastWeekBody', 'lastWeekTotal', attendanceData);
                } catch (error) {
                    console.error('Ï∂úÍ∑ºÎ∂Ä Î†åÎçîÎßÅ Ïò§Î•ò:', error);
                    showToast('Ï∂úÍ∑ºÎ∂Ä Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§');
                }
            }
            
            // Ï£ºÍ∞Ñ Îç∞Ïù¥ÌÑ∞ Î†åÎçîÎßÅ
            function renderWeekData(weekStart, tableBodyId, totalId, attendanceData) {
                const tableBody = document.getElementById(tableBodyId);
                tableBody.innerHTML = '';
                
                let weekdayTotalHours = 0; // Ï£ºÏ§ë(Ïõî~Í∏à) Ï¥ù Í∑ºÎ¨¥ ÏãúÍ∞Ñ
                
                // Ìï¥Îãπ Ï£ºÏùò 7Ïùº Îç∞Ïù¥ÌÑ∞ Î†åÎçîÎßÅ
                for (let i = 0; i < 7; i++) {
                    const date = new Date(weekStart);
                    date.setDate(date.getDate() + i);
                    
                    const dateKey = date.toISOString().split('T')[0];
                    const dayRecord = attendanceData[dateKey] || {};
                    
                    const row = document.createElement('tr');
                    
                    // ÎÇ†Ïßú
                    const dateCell = document.createElement('td');
                    dateCell.textContent = `${date.getDate()}Ïùº`;
                    row.appendChild(dateCell);
                    
                    // ÏöîÏùº
                    const dayCell = document.createElement('td');
                    const dayOfWeek = getDayOfWeek(date);
                    dayCell.textContent = dayOfWeek;
                    row.appendChild(dayCell);
                    
                    // Ï∂úÍ∑º ÏãúÍ∞Ñ
                    const clockInCell = document.createElement('td');
                    if (dayRecord.clockIn) {
                        const clockInDate = new Date(dayRecord.clockIn);
                        clockInCell.textContent = `${String(clockInDate.getHours()).padStart(2, '0')}:${String(clockInDate.getMinutes()).padStart(2, '0')}`;
                    } else {
                        clockInCell.textContent = '-';
                    }
                    row.appendChild(clockInCell);
                    
                    // Ìá¥Í∑º ÏãúÍ∞Ñ
                    const clockOutCell = document.createElement('td');
                    if (dayRecord.clockOut) {
                        const clockOutDate = new Date(dayRecord.clockOut);
                        clockOutCell.textContent = `${String(clockOutDate.getHours()).padStart(2, '0')}:${String(clockOutDate.getMinutes()).padStart(2, '0')}`;
                    } else {
                        clockOutCell.textContent = '-';
                    }
                    row.appendChild(clockOutCell);
                    
                    // Í∑ºÎ¨¥ ÏãúÍ∞Ñ
                    const workHoursCell = document.createElement('td');
                    const workHours = calculateWorkHours(dayRecord.clockIn, dayRecord.clockOut);
                    
                    if (workHours > 0) {
                        workHoursCell.textContent = `${workHours.toFixed(1)}ÏãúÍ∞Ñ`;
                        
                        // ÌèâÏùº(Ïõî~Í∏à)Ïù∏ Í≤ΩÏö∞ÏóêÎßå Ï¥ù Í∑ºÎ¨¥ ÏãúÍ∞ÑÏóê Ï∂îÍ∞Ä
                        const day = date.getDay();
                        if (day >= 1 && day <= 5) { // 1=ÏõîÏöîÏùº, 5=Í∏àÏöîÏùº
                            weekdayTotalHours += workHours;
                        }
                    } else {
                        workHoursCell.textContent = '-';
                    }
                    row.appendChild(workHoursCell);
                    
                    tableBody.appendChild(row);
                }
                
                // Ï£ºÏ§ë Ï¥ù Í∑ºÎ¨¥ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
                document.getElementById(totalId).textContent = `Ï£ºÏ§ëÍ∑ºÎ¨¥ÏãúÍ∞Ñ(Ïõî~Í∏à): ${weekdayTotalHours.toFixed(1)}ÏãúÍ∞Ñ`;
            }
            
            // Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞ - Î∞±ÏóÖ Í∏∞Îä•
            function exportData() {
                return new Promise(async (resolve, reject) => {
                    try {
                        const data = await getAttendanceData();
                        const dataStr = JSON.stringify(data);
                        const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
                        
                        // ÌååÏùº Îã§Ïö¥Î°úÎìú
                        const exportFileDefaultName = 'darakwon-attendance-backup.json';
                        const linkElement = document.createElement('a');
                        linkElement.setAttribute('href', dataUri);
                        linkElement.setAttribute('download', exportFileDefaultName);
                        linkElement.click();
                        resolve(true);
                    } catch (error) {
                        console.error("Îç∞Ïù¥ÌÑ∞ ÎÇ¥Î≥¥ÎÇ¥Í∏∞ Ïã§Ìå®:", error);
                        reject(error);
                    }
                });
            }
            
            // Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ - Î≥µÏõê Í∏∞Îä•
            function importData(jsonData) {
                return new Promise(async (resolve, reject) => {
                    try {
                        const data = JSON.parse(jsonData);
                        await saveAttendanceData(data);
                        await renderAttendanceSheet();
                        resolve(true);
                    } catch (error) {
                        console.error("Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®:", error);
                        reject(error);
                    }
                });
            }
            
            // Îç∞Ïù¥ÌÑ∞ Î∞±ÏóÖ Î≤ÑÌäº Ïù¥Î≤§Ìä∏
            document.getElementById('backupBtn').addEventListener('click', async function() {
                vibrate(this);
                try {
                    await exportData();
                    showToast('Î∞±ÏóÖ ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§');
                } catch (error) {
                    showToast('Î∞±ÏóÖ ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§');
                }
            });
            
            // Îç∞Ïù¥ÌÑ∞ Î≥µÏõê ÌååÏùº ÏÑ†ÌÉù Ïù¥Î≤§Ìä∏
            document.getElementById('restoreInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = async function(e) {
                    try {
                        await importData(e.target.result);
                        showToast('Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú Î≥µÏõêÎêòÏóàÏäµÎãàÎã§');
                    } catch (error) {
                        showToast('Îç∞Ïù¥ÌÑ∞ Î≥µÏõê Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§');
                    }
                };
                reader.readAsText(file);
            });
            
            // Î≥µÏõê Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÌååÏùº ÏÑ†ÌÉù Îã§Ïù¥ÏñºÎ°úÍ∑∏ Ïó¥Í∏∞
            document.getElementById('restoreBtn').addEventListener('click', function() {
                vibrate(this);
                document.getElementById('restoreInput').click();
            });
            
            // Íµ¨Í∏Ä API Ï†ïÎ≥¥ Ï†ÄÏû• Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            googleConfigBtn.addEventListener('click', function() {
                vibrate(this);
                
                // Ï†ÄÏû•Îêú ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞
                GoogleDriveManager.loadConfig();
                
                // Î™®Îã¨ ÌëúÏãú
                googleConfigModal.style.display = 'flex';
            });
            
            // Íµ¨Í∏Ä ÏÑ§Ï†ï Ï†ÄÏû• Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            configSaveBtn.addEventListener('click', async function() {
                const apiKey = apiKeyInput.value.trim();
                const clientId = clientIdInput.value.trim();
                
                if (!apiKey || !clientId) {
                    showToast('API KeyÏôÄ Client IDÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                    return;
                }
                
                // ÏÑ§Ï†ï Ï†ÄÏû•
                if (GoogleDriveManager.saveConfig(apiKey, clientId)) {
                    googleConfigModal.style.display = 'none';
                    showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                    
                    // Íµ¨Í∏Ä API Ï¥àÍ∏∞Ìôî ÏãúÎèÑ
                    try {
                        await GoogleDriveManager.init();
                        showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞ÎèôÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.');
                    } catch (error) {
                        console.error('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ï¥àÍ∏∞Ìôî Ïò§Î•ò:', error);
                        showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                    }
                } else {
                    showToast('ÏÑ§Ï†ï Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                }
            });
            
            // Íµ¨Í∏Ä ÏÑ§Ï†ï Ï∑®ÏÜå Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            configCancelBtn.addEventListener('click', function() {
                googleConfigModal.style.display = 'none';
            });
            
            // Íµ¨Í∏Ä Î∞±ÏóÖ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            googleBackupBtn.addEventListener('click', async function() {
                vibrate(this);
                
                // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÏÑ§Ï†ï ÌôïÏù∏
                if (!GoogleDriveManager.API_KEY || !GoogleDriveManager.CLIENT_ID) {
                    showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å API ÏÑ§Ï†ïÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                    googleConfigBtn.click(); // ÏÑ§Ï†ï Î™®Îã¨ Ïó¥Í∏∞
                    return;
                }
                
                try {
                    // ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞
                    const data = await getAttendanceData();
                    const jsonData = JSON.stringify(data);
                    
                    // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Î∞±ÏóÖ
                    await GoogleDriveManager.backupFile(jsonData);
                    showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóê Î∞±ÏóÖÎêòÏóàÏäµÎãàÎã§.');
                } catch (error) {
                    console.error('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Î∞±ÏóÖ Ïò§Î•ò:', error);
                    showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Î∞±ÏóÖ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ' + error.message);
                }
            });
            
            // Íµ¨Í∏Ä Î≥µÏõê Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
            googleRestoreBtn.addEventListener('click', async function() {
                vibrate(this);
                
                // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÏÑ§Ï†ï ÌôïÏù∏
                if (!GoogleDriveManager.API_KEY || !GoogleDriveManager.CLIENT_ID) {
                    showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å API ÏÑ§Ï†ïÏù¥ ÌïÑÏöîÌï©ÎãàÎã§.');
                    googleConfigBtn.click(); // ÏÑ§Ï†ï Î™®Îã¨ Ïó¥Í∏∞
                    return;
                }
                
                try {
                    // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Î≥µÏõê
                    const data = await GoogleDriveManager.restoreFile();
                    
                    // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
                    await saveAttendanceData(data);
                    
                    // Ï∂úÍ∑ºÎ∂Ä Îã§Ïãú Î†åÎçîÎßÅ
                    await renderAttendanceSheet();
                    
                    showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏åÏóêÏÑú Îç∞Ïù¥ÌÑ∞Í∞Ä Î≥µÏõêÎêòÏóàÏäµÎãàÎã§.');
                } catch (error) {
                    console.error('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Î≥µÏõê Ïò§Î•ò:', error);
                    showToast('Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Î≥µÏõê Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: ' + error.message);
                }
            });
            
            // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            googleConfigModal.addEventListener('click', function(e) {
                if (e.target === googleConfigModal) {
                    googleConfigModal.style.display = 'none';
                }
            });
            
            // Î™®Î∞îÏùº ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏ ÏµúÏ†ÅÌôî
            document.addEventListener('touchstart', function() {}, {passive: true});
            
            // Ïï± Ï¥àÍ∏∞Ìôî Ìï®Ïàò
            async function initApp() {
                // Ïä§ÌÜ†Î¶¨ÏßÄ Ï¥àÍ∏∞Ìôî
                await StorageManager.init();
                
                // Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å ÏÑ§Ï†ï Î°úÎìú
                if (GoogleDriveManager.loadConfig()) {
                    googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: ÏÑ§Ï†ïÎê® (Ïó∞Í≤∞ ÎåÄÍ∏∞ Ï§ë)';
                } else {
                    googleStatus.textContent = 'Íµ¨Í∏Ä ÎìúÎùºÏù¥Î∏å Ïó∞Îèô ÏÉÅÌÉú: ÏÑ§Ï†ï ÌïÑÏöî';
                }
                
                // Ïï±Ïù¥ Î°úÎìúÎê† Îïå ÌÜ†Ïä§Ìä∏ Î©îÏãúÏßÄ ÌëúÏãú
                setTimeout(() => {
                    showToast('Darakwon Attendance Ïï±Ïù¥ Ï§ÄÎπÑÎêòÏóàÏäµÎãàÎã§', 3000);
                }, 500);
                
                // Ï¥àÍ∏∞Ìôî Ïãú Ïò§ÎûòÎêú Îç∞Ïù¥ÌÑ∞ Ï†ïÎ¶¨
                cleanupOldData();
            }
            
            // Ïï± Ï¥àÍ∏∞Ìôî
            initApp();
        });
    </script>
</body>
</html>